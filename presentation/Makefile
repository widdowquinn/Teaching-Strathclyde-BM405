# Makefile 
#
# Compiles presentations and handouts in .pdf format for the Introduction to
# Bioinformatics training course BM405, delivered at the University of
# Strathclyde.
#
# To generate all presentation files, issue `make presentation` or
# `make slides`
#
# To generate all handouts, issue `make handouts`.
#
# To generate both presentation files and handouts, issue `make all`.
#
# To manually remove intermediate/auxiliary LaTeX files, issue 
# `make clean_intermediates`; to clean .pdf output as well, issue
# `make clean`.
#
# Using Make to build the slides automatically removes the
# auxiliary/intermediate LaTeX files.
#
# (c) 2014-2015 James Hutton Institute
# Author: Leighton Pritchard

.PHONY : all
all : presentation handouts

.PHONY : presentation
presentation : part1_slides.pdf part2_slides.pdf part3_slides.pdf \
	part4_slides.pdf part5_slides.pdf BM405_slides.pdf

.PHONY : slides
slides : presentation 

.PHONY : handouts
handouts : part1_handouts.pdf part2_handouts.pdf part3_handouts.pdf \
	part4_handouts.pdf part5_handouts.pdf BM405_handouts.pdf

# Individual presentation sections
###
.PHONY : part1
part1 : part1_slides.pdf part1_handouts.pdf

.PHONY : part2
part2 : part2_slides.pdf part2_handouts.pdf

.PHONY : part3
part3 : part3_slides.pdf part3_handouts.pdf

.PHONY : part4
part4 : part4_slides.pdf part4_handouts.pdf

.PHONY : part5
part5 : part5_slides.pdf part5_handouts.pdf

# Clean up intermediate files generated by LaTeX
.PHONY : clean_intermediates
clean_intermediates:
	rm -f *.aux *.log *.nav *.out *.snm *.synctex.gz* *.toc *.vrb
	rm -f sections/*.aux

# Clean up output files (i.e. slides/handounts)
.PHONY : clean_pdf
clean_pdf:
	rm -f *.pdf

# Clean up both intermediate and output files
.PHONY : clean
clean: clean_intermediates clean_pdf


# Currently, changing any sub-file will trigger regeneration of all
# output PDF files.
%.pdf : %.tex sections/*.tex images/*.png images/*.jpg images/*.pdf \
       handoutWithNotes.sty
	pdflatex $<
	pdflatex $<
	make clean_intermediates
